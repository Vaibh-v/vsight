import type { NextApiRequest, NextApiResponse } from "next";import { getToken } from "next-auth/jwt";import { gaListProperties } from "../../../../lib/google";
export default async function handler(req:NextApiRequest,res:NextApiResponse){const token=await getToken({req,secret:process.env.NEXTAUTH_SECRET});if(!token?.access_token) return res.status(401).json({error:"Not authenticated"});try{const props=await gaListProperties(token.access_token as string);res.status(200).json({properties:props});}catch(e:any){res.status(500).json({error:e.message||"Unexpected error"});}}
